!function(){"use strict";angular.module("bookshopApp",["ngTouch","ngRoute","ngResource","ui.bootstrap","angularUtils.directives.dirPagination"]).config(function($routeProvider,$compileProvider,$logProvider,$httpProvider){$compileProvider.debugInfoEnabled(!1),$logProvider.debugEnabled(!1),$httpProvider.interceptors.push("anInterceptor"),$routeProvider.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html"}).when("/contact",{templateUrl:"views/contact.html"}).when("/admin/books",{templateUrl:"views/book.html",controller:"BookCtrl"}).when("/admin/books/add",{templateUrl:"views/book_form.html",controller:"BookAddCtrl"}).when("/admin/books/edit/:slug",{templateUrl:"views/book_form.html",controller:"BookAddCtrl"})})}(),function(){"use strict";angular.module("bookshopApp").controller("AlertCtrl",function($log,$scope){$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.$on("error",function(){$scope.alerts=[{type:"danger",msg:"There was a problem in the server!"}]}),$scope.$on("success",function(){$scope.alerts=[{type:"success",msg:"Operation is success!"}]}),$scope.$on("created",function(){$scope.alerts=[{type:"success",msg:"Data is has been saved!"}]})})}(),function(){"use strict";angular.module("bookshopApp").controller("BookCtrl",function($log,$scope,$rootScope,BookService){function extractSlug(uri){return uri.split("/").pop()}BookService.query(function(books){$log.debug(books),$scope.books=books},function(error){}),$scope.remove=function(param){var uri=extractSlug(param._links.href);$log.debug(uri),BookService.delete({slug:uri},function(){$rootScope.$broadcast("refreshTable")},function(error){})},$scope.$on("refreshTable",function(){BookService.query(function(books){$log.debug(books),$scope.books=books},function(error){})})})}(),function(){"use strict";angular.module("bookshopApp").controller("BookAddCtrl",function($log,$scope,$routeParams,BookService){var slug=$routeParams.slug;$log.debug("slug: "+slug),slug?BookService.get({slug:slug},function(data){$scope.book=data},function(error){}):$scope.book={tax_included:!1},$scope.submit=function(){slug?BookService.update({slug:slug},$scope.book):BookService.save($scope.book)}})}(),function(){"use strict";angular.module("bookshopApp").controller("MainCtrl",function($log,$scope,$rootScope,BookService){BookService.query(function(books){$scope.books=books},function(error){$rootScope.$broadcast("error")})})}(),function(){"use strict";angular.module("bookshopApp").directive("anLoader",function($log){return{restrict:"EA",replace:!0,templateUrl:"views/templates/loader.html",link:function(scope,element){function hideElement(){element.css("display","none")}var shownType=element.css("display");scope.$on("loader_show",function(){$log.debug("receive broadcast to show loader"),element.css("display",shownType)}),scope.$on("loader_hide",function(){$log.debug("receive broadcast to hide loader"),hideElement()}),hideElement()}}})}(),function(){"use strict";angular.module("bookshopApp").directive("anSearch",function(){return{restrict:"E",replace:!0,templateUrl:"views/templates/search.html"}})}(),function(){"use strict";angular.module("bookshopApp").factory("BookService",function($log,$resource){return $resource("resources/books/:slug",{slug:"@slug"},{update:{method:"PUT"}})})}(),function(){"use strict";angular.module("bookshopApp").factory("anInterceptor",function($q,$log,$rootScope){var loadings=0;return{request:function(config){return $log.debug("request interceptor"),loadings++,$rootScope.$broadcast("loader_show"),config},response:function(response){return $log.debug("response interceptor"),0==--loadings&&$rootScope.$broadcast("loader_hide"),204===response.status?$rootScope.$broadcast("success"):201===response.status&&$rootScope.$broadcast("created"),response},responseError:function(response){return $log.debug("responseError interceptor"),400===response.status&&$rootScope.$broadcast("error"),0==--loadings&&$rootScope.$broadcast("loader_hide"),$q.reject(response)}}})}();